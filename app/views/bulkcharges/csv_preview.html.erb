<h1>CSV Preview for Bulk Charge #<%= @bulk_charge.id %></h1>

<% if @bulk_charge.csv_file.attached? %>
  <p>
    Attached file:
    <%= link_to @bulk_charge.csv_file.filename, rails_blob_path(@bulk_charge.csv_file, disposition: "attachment") %>
  </p>
<% else %>
  <p>No CSV file attached.</p>
<% end %>

<% if @csv_rows.any? %>
  <table border="1">
    <thead>
      <tr>
        <% @csv_rows.headers.each do |header| %>
          <th><%= header %></th>
        <% end %>
      </tr>
    </thead>
    <tbody>
      <% @csv_rows.each do |row| %>
        <tr>
          <% row.each do |_, value| %>
            <td><%= value %></td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <p>No CSV file attached or file is empty.</p>
<% end %>

<%= link_to "Back to Bulk Charges", bulkcharges_path %>