  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "accounts"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "accounts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" bigint NOT NULL, "blob_id" bigint NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_variant_records"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_variant_records" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "blob_id" bigint NOT NULL, "variation_digest" varchar NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_variant_records_uniqueness" ON "active_storage_variant_records" ("blob_id", "variation_digest")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "bulk_charges"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "bulk_charges" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "status" integer DEFAULT 0, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (1.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "charge_results"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "charge_results" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "bulk_charge_id" integer NOT NULL, "row_number" integer, "status" varchar, "omise_charge_id" varchar, "token_response" json, "charge_response" json, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_charge_results_on_bulk_charge_id" ON "charge_results" ("bulk_charge_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "email" varchar, "password" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.3ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.4ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.9ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TEMPORARY TABLE "aactive_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" bigint NOT NULL, "blob_id" bigint NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "tindex_aactive_storage_attachments_uniqueness" ON "aactive_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aactive_storage_attachments_on_blob_id" ON "aactive_storage_attachments" ("blob_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aactive_storage_attachments" ("id","name","record_type","record_id","blob_id","created_at")
                     SELECT "id","name","record_type","record_id","blob_id","created_at" FROM "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "active_storage_attachments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" bigint NOT NULL, "blob_id" bigint NOT NULL, "created_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_c3b3935057"
FOREIGN KEY ("blob_id")
  REFERENCES "active_storage_blobs" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("id","name","record_type","record_id","blob_id","created_at")
                     SELECT "id","name","record_type","record_id","blob_id","created_at" FROM "aactive_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aactive_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TEMPORARY TABLE "aactive_storage_variant_records" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "blob_id" bigint NOT NULL, "variation_digest" varchar NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "tindex_aactive_storage_variant_records_uniqueness" ON "aactive_storage_variant_records" ("blob_id", "variation_digest")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aactive_storage_variant_records" ("id","blob_id","variation_digest")
                     SELECT "id","blob_id","variation_digest" FROM "active_storage_variant_records"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "active_storage_variant_records"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_variant_records" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "blob_id" bigint NOT NULL, "variation_digest" varchar NOT NULL, CONSTRAINT "fk_rails_993965df05"
FOREIGN KEY ("blob_id")
  REFERENCES "active_storage_blobs" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_variant_records_uniqueness" ON "active_storage_variant_records" ("blob_id", "variation_digest")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_variant_records" ("id","blob_id","variation_digest")
                     SELECT "id","blob_id","variation_digest" FROM "aactive_storage_variant_records"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aactive_storage_variant_records"[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TEMPORARY TABLE "acharge_results" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "bulk_charge_id" integer NOT NULL, "row_number" integer, "status" varchar, "omise_charge_id" varchar, "token_response" json, "charge_response" json, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_acharge_results_on_bulk_charge_id" ON "acharge_results" ("bulk_charge_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "acharge_results" ("id","bulk_charge_id","row_number","status","omise_charge_id","token_response","charge_response","created_at","updated_at")
                     SELECT "id","bulk_charge_id","row_number","status","omise_charge_id","token_response","charge_response","created_at","updated_at" FROM "charge_results"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "charge_results"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "charge_results" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "bulk_charge_id" integer NOT NULL, "row_number" integer, "status" varchar, "omise_charge_id" varchar, "token_response" json, "charge_response" json, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_a0a77797b6"
FOREIGN KEY ("bulk_charge_id")
  REFERENCES "bulk_charges" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_charge_results_on_bulk_charge_id" ON "charge_results" ("bulk_charge_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "charge_results" ("id","bulk_charge_id","row_number","status","omise_charge_id","token_response","charge_response","created_at","updated_at")
                     SELECT "id","bulk_charge_id","row_number","status","omise_charge_id","token_response","charge_response","created_at","updated_at" FROM "acharge_results"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "acharge_results"[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20250725062114)[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20250725055806),
(20250725052924),
(20250725052815),
(20250724100319),
(20250724044235),
(20250724044136),
(20250724042551);[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-07-29 14:03:21.296528', '2025-07-29 14:03:21.296529') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', 'ab50361daaccf99bff2bbfb6955f7410e8a609bf', '2025-07-29 14:03:21.298100', '2025-07-29 14:03:21.298100') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.5ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.7ms)[0m  [1m[31mDELETE FROM "accounts";
DELETE FROM "bulk_charges";
DELETE FROM "charge_results";
DELETE FROM "users";
INSERT INTO "accounts" ("id", "created_at", "updated_at") VALUES (NULL, NULL, NULL), (NULL, NULL, NULL);
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 15:53:59.329772', '2025-07-29 15:53:59.329772'), (298486374, NULL, '2025-07-29 15:53:59.329772', '2025-07-29 15:53:59.329772');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 15:53:59.330564', '2025-07-29 15:53:59.330564'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 15:53:59.330564', '2025-07-29 15:53:59.330564');
INSERT INTO "users" ("id", "name", "email", "password", "created_at", "updated_at") VALUES (NULL, 'MyString', 'MyString', NULL, NULL, NULL), (NULL, 'MyString', 'MyString', NULL, NULL, NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.6ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 15:55:05.001598', '2025-07-29 15:55:05.001598'), (298486374, NULL, '2025-07-29 15:55:05.001598', '2025-07-29 15:55:05.001598');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 15:55:05.002438', '2025-07-29 15:55:05.002438'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 15:55:05.002438', '2025-07-29 15:55:05.002438')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------
BulkchargesControllerTest: test_index
-------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.9ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (1.0ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 15:56:39.096473', '2025-07-29 15:56:39.096473'), (298486374, NULL, '2025-07-29 15:56:39.096473', '2025-07-29 15:56:39.096473');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 15:56:39.097716', '2025-07-29 15:56:39.097716'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 15:56:39.097716', '2025-07-29 15:56:39.097716')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.3ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------
BulkchargesControllerTest: test_index
-------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.5ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.2ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 15:57:15.913979', '2025-07-29 15:57:15.913979'), (298486374, NULL, '2025-07-29 15:57:15.913979', '2025-07-29 15:57:15.913979');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 15:57:15.914855', '2025-07-29 15:57:15.914855'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 15:57:15.914855', '2025-07-29 15:57:15.914855')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------
BulkchargesControllerTest: test_index
-------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.4ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.2ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 15:58:27.112305', '2025-07-29 15:58:27.112305'), (298486374, NULL, '2025-07-29 15:58:27.112305', '2025-07-29 15:58:27.112305');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 15:58:27.113093', '2025-07-29 15:58:27.113093'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 15:58:27.113093', '2025-07-29 15:58:27.113093')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------
BulkchargesControllerTest: test_index
-------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.5ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 15:59:21.745701', '2025-07-29 15:59:21.745701'), (298486374, NULL, '2025-07-29 15:59:21.745701', '2025-07-29 15:59:21.745701');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 15:59:21.746529', '2025-07-29 15:59:21.746529'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 15:59:21.746529', '2025-07-29 15:59:21.746529')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------
BulkchargesControllerTest: test_index
-------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.5ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:00:07.947272', '2025-07-29 16:00:07.947272'), (298486374, NULL, '2025-07-29 16:00:07.947272', '2025-07-29 16:00:07.947272');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:00:07.948111', '2025-07-29 16:00:07.948111'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:00:07.948111', '2025-07-29 16:00:07.948111')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------
BulkchargesControllerTest: test_index
-------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (2.4ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.5ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:19:41.949555', '2025-07-29 16:19:41.949555'), (298486374, NULL, '2025-07-29 16:19:41.949555', '2025-07-29 16:19:41.949555');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:19:41.950422', '2025-07-29 16:19:41.950422'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:19:41.950422', '2025-07-29 16:19:41.950422')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------
BulkchargesControllerTest: test_upload_csv
------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.7ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:27:04.014960', '2025-07-29 16:27:04.014960'), (298486374, NULL, '2025-07-29 16:27:04.014960', '2025-07-29 16:27:04.014960');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:27:04.015834', '2025-07-29 16:27:04.015834'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:27:04.015834', '2025-07-29 16:27:04.015834')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.7ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:27:26.461363', '2025-07-29 16:27:26.461363'), (298486374, NULL, '2025-07-29 16:27:26.461363', '2025-07-29 16:27:26.461363');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:27:26.462305', '2025-07-29 16:27:26.462305'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:27:26.462305', '2025-07-29 16:27:26.462305')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.6ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.5ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:31:29.675447', '2025-07-29 16:31:29.675447'), (298486374, NULL, '2025-07-29 16:31:29.675447', '2025-07-29 16:31:29.675447');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:31:29.676532', '2025-07-29 16:31:29.676532'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:31:29.676532', '2025-07-29 16:31:29.676532')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.5ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:32:04.377739', '2025-07-29 16:32:04.377739'), (298486374, NULL, '2025-07-29 16:32:04.377739', '2025-07-29 16:32:04.377739');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:32:04.378986', '2025-07-29 16:32:04.378986'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:32:04.378986', '2025-07-29 16:32:04.378986')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:32:04.399171"], ["updated_at", "2025-07-29 16:32:04.399171"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.5ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.2ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:32:35.440036', '2025-07-29 16:32:35.440036'), (298486374, NULL, '2025-07-29 16:32:35.440036', '2025-07-29 16:32:35.440036');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:32:35.440929', '2025-07-29 16:32:35.440929'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:32:35.440929', '2025-07-29 16:32:35.440929')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:32:35.461730"], ["updated_at", "2025-07-29 16:32:35.461730"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "1rua1zg8gy694x4ufepuyb9p237o"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:32:35.491000"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:32:35.492177"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:32:35.493011"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: 1rua1zg8gy694x4ufepuyb9p237o (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:32:35.501672"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:32:35 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.4ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 1.2ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 6.4ms | GC: 0.0ms)
Completed 200 OK in 23ms (Views: 8.4ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.4ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:34:13.470217', '2025-07-29 16:34:13.470217'), (298486374, NULL, '2025-07-29 16:34:13.470217', '2025-07-29 16:34:13.470217');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:34:13.471016', '2025-07-29 16:34:13.471016'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:34:13.471016', '2025-07-29 16:34:13.471016')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:34:13.491712"], ["updated_at", "2025-07-29 16:34:13.491712"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "i3dwjnipwp87bzlu7rtiin806gqu"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:34:13.518828"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:34:13.520069"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:34:13.520901"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: i3dwjnipwp87bzlu7rtiin806gqu (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:34:13.529697"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:34:13 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 0.9ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 6.2ms | GC: 0.0ms)
Completed 200 OK in 22ms (Views: 8.6ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:34:13.604823"], ["updated_at", "2025-07-29 16:34:13.604823"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "m4a3zaqa4k6k8bh7zn5bjfnje5aj"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:34:13.620979"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:34:13.621711"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:34:13.622670"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: m4a3zaqa4k6k8bh7zn5bjfnje5aj (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:34:13.634943"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 16:34:13 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 2.0ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 2.2ms | GC: 0.0ms)
Completed 200 OK in 3ms (Views: 2.3ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:34:13.646984"], ["updated_at", "2025-07-29 16:34:13.646984"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "mi1ftotmpu5ome6f6rny0k5cdk5k"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:34:13.652309"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:34:13.652572"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:34:13.653673"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: mi1ftotmpu5ome6f6rny0k5cdk5k (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.5ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:34:13.657810"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
BulkchargesControllerTest - test_should_create_bulk_charge: ArgumentError raised.
If you expected this exception, use `assert_raises` as near to the code that raises as possible.
Other block based assertions (e.g. `assert_difference`) can be used, as long as `assert_raises` is inside their block.

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.6ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:35:12.346528', '2025-07-29 16:35:12.346528'), (298486374, NULL, '2025-07-29 16:35:12.346528', '2025-07-29 16:35:12.346528');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:35:12.347531', '2025-07-29 16:35:12.347531'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:35:12.347531', '2025-07-29 16:35:12.347531')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:35:12.369733"], ["updated_at", "2025-07-29 16:35:12.369733"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "xmll3f69dksvg9sn0uczh9tkp02l"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:35:12.396583"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:35:12.397780"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:35:12.398552"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: xmll3f69dksvg9sn0uczh9tkp02l (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:35:12.407568"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:35:12 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x0000000130a7f108 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-74312-wttjx3.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:35:12.467946"], ["updated_at", "2025-07-29 16:35:12.467946"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "824djkfbxmeyue45l238ids14dn9"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:35:12.471771"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 16:35:12.472306"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:35:12.472717"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: 824djkfbxmeyue45l238ids14dn9 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:35:12.483565"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (9.0ms) [0m[34mDownloaded file from key: 824djkfbxmeyue45l238ids14dn9[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 47ms (ActiveRecord: 0.6ms (10 queries, 0 cached) | GC: 8.9ms)
  [1m[36mBulkCharge Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.2ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:35:12.514829"], ["updated_at", "2025-07-29 16:35:12.514829"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "p54jir2hcmw2at9ae54qxoz7lmwy"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:35:12.527368"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:35:12.528471"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:35:12.530419"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: p54jir2hcmw2at9ae54qxoz7lmwy (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:35:12.536488"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:35:12 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 1.8ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 7.1ms | GC: 0.3ms)
Completed 200 OK in 19ms (Views: 9.8ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.7ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:35:12.561916"], ["updated_at", "2025-07-29 16:35:12.561916"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "jp29oiwxe29cb6zbnyo3zo1cv7mu"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:35:12.567408"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:35:12.568313"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:35:12.570707"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: jp29oiwxe29cb6zbnyo3zo1cv7mu (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:35:12.575414"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 16:35:12 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 1.4ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 1.9ms | GC: 0.0ms)
Completed 200 OK in 3ms (Views: 2.6ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.6ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:35:53.720909', '2025-07-29 16:35:53.720909'), (298486374, NULL, '2025-07-29 16:35:53.720909', '2025-07-29 16:35:53.720909');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:35:53.722044', '2025-07-29 16:35:53.722044'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:35:53.722044', '2025-07-29 16:35:53.722044')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:35:53.743297"], ["updated_at", "2025-07-29 16:35:53.743297"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "gq69qrdikzl6mj2ouq0gtubjmlp6"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:35:53.770735"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:35:53.771935"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:35:53.772756"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: gq69qrdikzl6mj2ouq0gtubjmlp6 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:35:53.781265"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 16:35:53 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.3ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 5.6ms | GC: 0.0ms)
Completed 200 OK in 24ms (Views: 8.4ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:35:53.856352"], ["updated_at", "2025-07-29 16:35:53.856352"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "qefdzcem0n6h21uw86b1et4m1bbp"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:35:53.862524"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:35:53.863369"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:35:53.864312"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: qefdzcem0n6h21uw86b1et4m1bbp (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:35:53.875455"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 16:35:53 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 1.7ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 1.9ms | GC: 0.0ms)
Completed 200 OK in 3ms (Views: 2.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:35:53.887659"], ["updated_at", "2025-07-29 16:35:53.887659"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "3k4neb0hn0tjg1c2hjr6so6g83x8"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:35:53.904256"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:35:53.905263"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:35:53.907738"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: 3k4neb0hn0tjg1c2hjr6so6g83x8 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.5ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:35:53.913411"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:35:53 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 1.0ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 2.3ms | GC: 0.0ms)
Completed 200 OK in 3ms (Views: 2.6ms | ActiveRecord: 0.0ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.5ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:35:53.919361"], ["updated_at", "2025-07-29 16:35:53.919361"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "kmv9tp2vi8cuwxs61dftrx22r15a"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:35:53.924503"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:35:53.925479"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:35:53.928007"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: kmv9tp2vi8cuwxs61dftrx22r15a (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:35:53.934003"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:35:53 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x0000000122cd7d50 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-74435-ya9dnm.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:35:53.942084"], ["updated_at", "2025-07-29 16:35:53.942084"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "brqv90g4j44uud6wu56f07qvz9jz"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:35:53.946107"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 16:35:53.946815"]]
  [1m[36mBulkCharge Update (0.4ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:35:53.947361"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: brqv90g4j44uud6wu56f07qvz9jz (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (1.8ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:35:53.951362"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.1ms) [0m[34mDownloaded file from key: brqv90g4j44uud6wu56f07qvz9jz[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 21ms (ActiveRecord: 2.4ms (10 queries, 0 cached) | GC: 0.2ms)
  [1m[36mBulkCharge Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.8ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.5ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:36:00.409811', '2025-07-29 16:36:00.409811'), (298486374, NULL, '2025-07-29 16:36:00.409811', '2025-07-29 16:36:00.409811');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:36:00.410859', '2025-07-29 16:36:00.410859'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:36:00.410859', '2025-07-29 16:36:00.410859')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:36:00.431759"], ["updated_at", "2025-07-29 16:36:00.431759"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "t5vzhcqq55nn1koj50dmbckw1yt0"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:36:00.458069"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:36:00.459672"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:00.460606"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: t5vzhcqq55nn1koj50dmbckw1yt0 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:00.471471"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:36:00 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 0.9ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 4.6ms | GC: 0.0ms)
Completed 200 OK in 20ms (Views: 6.6ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:36:00.541920"], ["updated_at", "2025-07-29 16:36:00.541920"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "77e8lx8w1ru2mobdeui1hz3qtg7v"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:36:00.548300"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:36:00.548997"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:00.550133"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: 77e8lx8w1ru2mobdeui1hz3qtg7v (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:00.562357"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 16:36:00 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.6ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 0.8ms | GC: 0.0ms)
Completed 200 OK in 4ms (Views: 0.9ms | ActiveRecord: 0.0ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:36:00.575799"], ["updated_at", "2025-07-29 16:36:00.575799"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "8o4bps293rv5g47788v6qxwaphe9"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:36:00.590988"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:36:00.591333"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:00.592729"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: 8o4bps293rv5g47788v6qxwaphe9 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.5ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:00.598190"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:36:00 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x000000012e05cfd8 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-74465-sfizs4.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:36:00.605105"], ["updated_at", "2025-07-29 16:36:00.605105"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dctag815skp5gi5dtnc8i4xsnasq"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:36:00.607925"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 16:36:00.608780"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:00.611615"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: dctag815skp5gi5dtnc8i4xsnasq (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:00.616231"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.1ms) [0m[34mDownloaded file from key: dctag815skp5gi5dtnc8i4xsnasq[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 19ms (ActiveRecord: 0.7ms (10 queries, 0 cached) | GC: 0.6ms)
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.3ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:36:00.629798"], ["updated_at", "2025-07-29 16:36:00.629798"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dmmq0vrkpiktf0kqxxel17dt1qww"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:36:00.635762"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:36:00.636332"]]
  [1m[36mBulkCharge Update (0.4ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:00.636880"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: dmmq0vrkpiktf0kqxxel17dt1qww (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (2.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.5ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:00.644272"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 16:36:00 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 1.7ms | GC: 0.2ms)
  Rendered layout layouts/application.html.erb (Duration: 2.9ms | GC: 0.2ms)
Completed 200 OK in 4ms (Views: 3.4ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.2ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.5ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:36:10.749723', '2025-07-29 16:36:10.749723'), (298486374, NULL, '2025-07-29 16:36:10.749723', '2025-07-29 16:36:10.749723');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:36:10.750822', '2025-07-29 16:36:10.750822'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:36:10.750822', '2025-07-29 16:36:10.750822')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:36:10.770589"], ["updated_at", "2025-07-29 16:36:10.770589"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "lme57fcqnaa83i2l6dvf1ysxgfpd"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:36:10.796370"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:36:10.797519"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:10.798284"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: lme57fcqnaa83i2l6dvf1ysxgfpd (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:10.807108"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:36:10 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x000000012f91dc70 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-74507-kwx3mi.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:36:10.864204"], ["updated_at", "2025-07-29 16:36:10.864204"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "tgwo9loywicuu7hm3rrqgwpe7i5i"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:36:10.867944"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 16:36:10.868496"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:10.868920"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: tgwo9loywicuu7hm3rrqgwpe7i5i (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:10.880036"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (13.2ms) [0m[34mDownloaded file from key: tgwo9loywicuu7hm3rrqgwpe7i5i[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 45ms (ActiveRecord: 0.6ms (10 queries, 0 cached) | GC: 10.0ms)
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.2ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:36:10.908910"], ["updated_at", "2025-07-29 16:36:10.908910"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "v3wanpkixd30k2bsreq9758bqw4b"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:36:10.920012"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:36:10.921078"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:10.923430"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: v3wanpkixd30k2bsreq9758bqw4b (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:10.929411"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 16:36:10 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 1.7ms | GC: 0.2ms)
  Rendered layout layouts/application.html.erb (Duration: 6.9ms | GC: 0.5ms)
Completed 200 OK in 17ms (Views: 9.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.8ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:36:10.953969"], ["updated_at", "2025-07-29 16:36:10.953969"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "eoexqrdhtojnast55jrdcr849von"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:36:10.959139"]]
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:36:10.960007"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:10.962558"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: eoexqrdhtojnast55jrdcr849von (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:10.967405"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 16:36:10 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.6ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 1.1ms | GC: 0.0ms)
Completed 200 OK in 7ms (Views: 1.8ms | ActiveRecord: 0.0ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:36:10.977726"], ["updated_at", "2025-07-29 16:36:10.977726"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "cee24s0zcvf37rmk1hfjf6on9m3a"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:36:10.983402"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:36:10.983849"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:10.984863"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: cee24s0zcvf37rmk1hfjf6on9m3a (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (2.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.5ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:10.993261"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:36:10 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.6ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 2.5ms | GC: 1.3ms)
  Rendered layout layouts/application.html.erb (Duration: 4.5ms | GC: 1.9ms)
Completed 200 OK in 6ms (Views: 4.1ms | ActiveRecord: 0.6ms (1 query, 0 cached) | GC: 2.5ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.5ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:36:14.291396', '2025-07-29 16:36:14.291396'), (298486374, NULL, '2025-07-29 16:36:14.291396', '2025-07-29 16:36:14.291396');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:36:14.292248', '2025-07-29 16:36:14.292248'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:36:14.292248', '2025-07-29 16:36:14.292248')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:36:14.308227"], ["updated_at", "2025-07-29 16:36:14.308227"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "tpoekhhutpzwhhuu651fhy81a70v"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:36:14.329149"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:36:14.330452"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:14.331276"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: tpoekhhutpzwhhuu651fhy81a70v (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:14.339567"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 16:36:14 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.3ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 4.1ms | GC: 0.0ms)
Completed 200 OK in 14ms (Views: 6.0ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:36:14.393075"], ["updated_at", "2025-07-29 16:36:14.393075"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dovfsgxpmv3wnj45kxwvkbqktw8p"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:36:14.409859"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:36:14.410569"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:14.411513"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: dovfsgxpmv3wnj45kxwvkbqktw8p (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:14.423079"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:36:14 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 0.9ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 1.0ms | GC: 0.0ms)
Completed 200 OK in 2ms (Views: 1.1ms | ActiveRecord: 0.0ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:36:14.434080"], ["updated_at", "2025-07-29 16:36:14.434080"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "03q6kb8slavi5sxsj9z6mu9bsrhn"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:36:14.440482"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:36:14.441415"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:14.443573"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: 03q6kb8slavi5sxsj9z6mu9bsrhn (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.5ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:14.448998"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:36:14 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x0000000126d07b28 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-74542-sh78u4.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:36:14.453906"], ["updated_at", "2025-07-29 16:36:14.453906"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "7i6hzkulesndv8ck7cvzwijtljom"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:36:14.457237"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 16:36:14.458069"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:14.460855"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: 7i6hzkulesndv8ck7cvzwijtljom (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:14.465442"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.1ms) [0m[34mDownloaded file from key: 7i6hzkulesndv8ck7cvzwijtljom[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 19ms (ActiveRecord: 0.7ms (10 queries, 0 cached) | GC: 0.4ms)
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.4ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:36:14.478815"], ["updated_at", "2025-07-29 16:36:14.478815"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "zrpc7tf02e3rxuhnoz95x75exa1j"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:36:14.484973"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:36:14.485481"]]
  [1m[36mBulkCharge Update (0.4ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:14.485974"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: zrpc7tf02e3rxuhnoz95x75exa1j (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (2.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.5ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:36:14.493090"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 16:36:14 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 1.2ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 2.4ms | GC: 0.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.4ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:39:37.966142', '2025-07-29 16:39:37.966142'), (298486374, NULL, '2025-07-29 16:39:37.966142', '2025-07-29 16:39:37.966142');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:39:37.967011', '2025-07-29 16:39:37.967011'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:39:37.967011', '2025-07-29 16:39:37.967011')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.8ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:39:54.946651', '2025-07-29 16:39:54.946651'), (298486374, NULL, '2025-07-29 16:39:54.946651', '2025-07-29 16:39:54.946651');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:39:54.948046', '2025-07-29 16:39:54.948046'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:39:54.948046', '2025-07-29 16:39:54.948046')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:39:54.970190"], ["updated_at", "2025-07-29 16:39:54.970190"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "7p9u2p413jb24yvktm3c1semuu2g"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:39:54.999002"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:39:55.000219"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:39:55.000993"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: 7p9u2p413jb24yvktm3c1semuu2g (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:39:55.010187"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:39:55 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x000000012e29dc70 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-75185-hkhsct.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:39:55.070942"], ["updated_at", "2025-07-29 16:39:55.070942"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "uztr1nk3sxazagotjwv8s0clv8fv"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:39:55.074777"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 16:39:55.075336"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:39:55.075763"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: uztr1nk3sxazagotjwv8s0clv8fv (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:39:55.087921"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (9.6ms) [0m[34mDownloaded file from key: uztr1nk3sxazagotjwv8s0clv8fv[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 44ms (ActiveRecord: 0.7ms (10 queries, 0 cached) | GC: 9.5ms)
  [1m[36mBulkCharge Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.2ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:39:55.114986"], ["updated_at", "2025-07-29 16:39:55.114986"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "hiosa82wkn7wmjm9ofrv1gsnp547"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:39:55.131084"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:39:55.132834"]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:39:55.135848"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: hiosa82wkn7wmjm9ofrv1gsnp547 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:39:55.144853"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:39:55 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 2.5ms | GC: 0.3ms)
  Rendered layout layouts/application.html.erb (Duration: 9.6ms | GC: 0.8ms)
Completed 200 OK in 22ms (Views: 12.6ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 1.1ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:39:55.175686"], ["updated_at", "2025-07-29 16:39:55.175686"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "8870m7qc854acqpmqwar98idov3e"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:39:55.182042"]]
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:39:55.182977"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:39:55.185391"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: 8870m7qc854acqpmqwar98idov3e (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:39:55.190625"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 16:39:55 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 2.4ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 3.0ms | GC: 0.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.3ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:39:55.201068"], ["updated_at", "2025-07-29 16:39:55.201068"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "vgj46mlhrnxf99uqgiqhw0tc9ilf"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:39:55.212158"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:39:55.212892"]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:39:55.215542"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: vgj46mlhrnxf99uqgiqhw0tc9ilf (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (2.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.6ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:39:55.225546"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 16:39:55 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (0.6ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.4ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 2.3ms | GC: 0.7ms)
Completed 200 OK in 9ms (Views: 3.1ms | ActiveRecord: 0.6ms (1 query, 0 cached) | GC: 2.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.9ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (1.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:48:11.982306', '2025-07-29 16:48:11.982306'), (298486374, NULL, '2025-07-29 16:48:11.982306', '2025-07-29 16:48:11.982306');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:48:11.983585', '2025-07-29 16:48:11.983585'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:48:11.983585', '2025-07-29 16:48:11.983585')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------
PagesControllerTest: test_should_get_index
------------------------------------------
Started GET "/" for 127.0.0.1 at 2025-07-29 16:48:12 +0700
Processing by PagesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering pages/index.html.erb within layouts/application
  Rendered pages/index.html.erb within layouts/application (Duration: 0.2ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 5.4ms | GC: 0.0ms)
Completed 200 OK in 21ms (Views: 7.8ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:48:12.076071"], ["updated_at", "2025-07-29 16:48:12.076071"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "yiw384uggmirlv8f88wyqz8s3dw1"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:48:12.102793"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:48:12.103937"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:48:12.104734"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: yiw384uggmirlv8f88wyqz8s3dw1 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:48:12.114039"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:48:12 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x0000000122e124e0 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-76553-o83l0r.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:48:12.134150"], ["updated_at", "2025-07-29 16:48:12.134150"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "phjlnubwex1ya77kantyu6u7gk2r"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:48:12.137175"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 16:48:12.137655"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:48:12.138029"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: phjlnubwex1ya77kantyu6u7gk2r (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:48:12.154955"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.1ms) [0m[34mDownloaded file from key: phjlnubwex1ya77kantyu6u7gk2r[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 42ms (ActiveRecord: 0.5ms (10 queries, 0 cached) | GC: 10.0ms)
  [1m[36mBulkCharge Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.2ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:48:12.172229"], ["updated_at", "2025-07-29 16:48:12.172229"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "7hyixitpguucw9ifkxaksknrq94b"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:48:12.182428"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:48:12.183796"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:48:12.186118"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: 7hyixitpguucw9ifkxaksknrq94b (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.5ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:48:12.189719"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 16:48:12 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.8ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 1.1ms | GC: 0.0ms)
Completed 200 OK in 7ms (Views: 1.6ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.2ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:48:12.208452"], ["updated_at", "2025-07-29 16:48:12.208452"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "bqswhm2u54p52vkyrjlajvx0e7fr"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:48:12.214975"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:48:12.215622"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:48:12.218331"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: bqswhm2u54p52vkyrjlajvx0e7fr (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:48:12.223799"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 16:48:12 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 1.6ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 2.9ms | GC: 0.2ms)
Completed 200 OK in 4ms (Views: 3.5ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.2ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:48:12.231165"], ["updated_at", "2025-07-29 16:48:12.231165"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "11jh6zoegoj71r95ey77mi0wy0fg"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:48:12.236781"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:48:12.237254"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:48:12.237587"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: 11jh6zoegoj71r95ey77mi0wy0fg (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (2.5ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.9ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:48:12.245496"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:48:12 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (1.8ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 2.8ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 3.1ms | GC: 0.0ms)
Completed 200 OK in 5ms (Views: 1.5ms | ActiveRecord: 1.8ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.7ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.2ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:54:51.420458', '2025-07-29 16:54:51.420458'), (298486374, NULL, '2025-07-29 16:54:51.420458', '2025-07-29 16:54:51.420458');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:54:51.421414', '2025-07-29 16:54:51.421414'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:54:51.421414', '2025-07-29 16:54:51.421414')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:54:51.443848"], ["updated_at", "2025-07-29 16:54:51.443848"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "7ryokmpdeuhggzuioge9gf8x6pfv"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:54:51.471318"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:54:51.472719"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:54:51.473727"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: 7ryokmpdeuhggzuioge9gf8x6pfv (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:54:51.483350"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 16:54:51 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.4ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 5.7ms | GC: 0.0ms)
Completed 200 OK in 25ms (Views: 8.6ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:54:51.560873"], ["updated_at", "2025-07-29 16:54:51.560873"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "seye1jsbjhmtmz7espzw4oo2v32f"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:54:51.577001"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:54:51.577758"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:54:51.578693"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: seye1jsbjhmtmz7espzw4oo2v32f (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:54:51.591276"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:54:51 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x000000012ed5c580 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-77739-fhtpka.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:54:51.606114"], ["updated_at", "2025-07-29 16:54:51.606114"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "4psaa5euh0hh8vsycd8z6wg96nnt"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:54:51.610229"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 16:54:51.611228"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:54:51.613173"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: 4psaa5euh0hh8vsycd8z6wg96nnt (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:54:51.617707"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.1ms) [0m[34mDownloaded file from key: 4psaa5euh0hh8vsycd8z6wg96nnt[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 21ms (ActiveRecord: 0.4ms (10 queries, 0 cached) | GC: 0.2ms)
  [1m[36mBulkCharge Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:54:51.634632"], ["updated_at", "2025-07-29 16:54:51.634632"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "tcufujngpyqb5ddovisg07m8xhab"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:54:51.643274"]]
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:54:51.645061"]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:54:51.651455"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: tcufujngpyqb5ddovisg07m8xhab (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.4ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:54:51.660473"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:54:51 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.2ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 3.1ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 4.1ms | GC: 0.0ms)
Completed 200 OK in 6ms (Views: 5.1ms | ActiveRecord: 0.2ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.3ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:54:51.672149"], ["updated_at", "2025-07-29 16:54:51.672149"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "zlbo76ypueg4a893d8tl25ryj788"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:54:51.680555"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:54:51.681274"]]
  [1m[36mBulkCharge Update (0.4ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:54:51.682032"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: zlbo76ypueg4a893d8tl25ryj788 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (2.5ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.6ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:54:51.690768"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 16:54:51 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 1.5ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 2.8ms | GC: 0.0ms)
Completed 200 OK in 4ms (Views: 3.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------
PagesControllerTest: test_should_get_index
------------------------------------------
Started GET "/" for 127.0.0.1 at 2025-07-29 16:54:51 +0700
Processing by PagesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering pages/index.html.erb within layouts/application
  Rendered pages/index.html.erb within layouts/application (Duration: 0.3ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 0.6ms | GC: 0.0ms)
Completed 200 OK in 2ms (Views: 1.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------------------
BulkChargeTest: test_should_save_bulk_charge_with_csv_file
----------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.6ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:54:51.708888"], ["updated_at", "2025-07-29 16:54:51.708888"]]
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "womzb543dtjb3rk177fc6d5gz5dl"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:54:51.714532"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:54:51.715192"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:54:51.715846"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: womzb543dtjb3rk177fc6d5gz5dl (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:54:51.718725"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-----------------------------------------------------------------
BulkChargeTest: test_should_not_save_bulk_charge_without_csv_file
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:54:51.719838"], ["updated_at", "2025-07-29 16:54:51.719838"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.7ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:55:11.845228', '2025-07-29 16:55:11.845228'), (298486374, NULL, '2025-07-29 16:55:11.845228', '2025-07-29 16:55:11.845228');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:55:11.846145', '2025-07-29 16:55:11.846145'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:55:11.846145', '2025-07-29 16:55:11.846145')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:55:11.867117"], ["updated_at", "2025-07-29 16:55:11.867117"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ucbxdhgwtsd8m8929bkodgp7lrdg"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:55:11.893207"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:55:11.894374"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:11.895146"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: ucbxdhgwtsd8m8929bkodgp7lrdg (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:11.903968"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 16:55:11 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 1.3ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 6.2ms | GC: 0.0ms)
Completed 200 OK in 21ms (Views: 8.3ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:55:11.976415"], ["updated_at", "2025-07-29 16:55:11.976415"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dfxzdksfme6ck01jzm9il5k9gm3l"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:55:11.982571"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:55:11.983115"]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:11.983845"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: dfxzdksfme6ck01jzm9il5k9gm3l (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:11.999226"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:55:12 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x0000000130c96310 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-77813-peykw7.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:55:12.022725"], ["updated_at", "2025-07-29 16:55:12.022725"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "7lnyi603hyjdc3a8rep35vpfqhw9"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:55:12.029571"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 16:55:12.030662"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:12.032660"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: 7lnyi603hyjdc3a8rep35vpfqhw9 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:12.037036"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.1ms) [0m[34mDownloaded file from key: 7lnyi603hyjdc3a8rep35vpfqhw9[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 32ms (ActiveRecord: 0.8ms (10 queries, 0 cached) | GC: 10.0ms)
  [1m[36mBulkCharge Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:55:12.049498"], ["updated_at", "2025-07-29 16:55:12.049498"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "lq02msu3k3msunduycen801am91r"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:55:12.055839"]]
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:55:12.056723"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:12.059502"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: lq02msu3k3msunduycen801am91r (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.4ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:12.064902"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:55:12 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 1.1ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 1.6ms | GC: 0.2ms)
Completed 200 OK in 3ms (Views: 2.3ms | ActiveRecord: 0.3ms (1 query, 0 cached) | GC: 0.2ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:55:12.071803"], ["updated_at", "2025-07-29 16:55:12.071803"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "frf9our3iwjd4aj7xmulfrum9zuf"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:55:12.078602"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:55:12.079119"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:12.080102"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: frf9our3iwjd4aj7xmulfrum9zuf (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.4ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (1.8ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.5ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:12.086841"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 16:55:12 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (0.6ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.4ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 1.6ms | GC: 0.0ms)
Completed 200 OK in 7ms (Views: 1.8ms | ActiveRecord: 0.6ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------------------
BulkChargeTest: test_should_save_bulk_charge_with_csv_file
----------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:55:12.100659"], ["updated_at", "2025-07-29 16:55:12.100659"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "iphe1tcerkyq7am4em4q5ed2d8zi"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:55:12.104401"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:55:12.104808"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:12.105313"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: iphe1tcerkyq7am4em4q5ed2d8zi (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:12.108326"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------
PagesControllerTest: test_should_get_index
------------------------------------------
Started GET "/" for 127.0.0.1 at 2025-07-29 16:55:12 +0700
Processing by PagesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering pages/index.html.erb within layouts/application
  Rendered pages/index.html.erb within layouts/application (Duration: 0.4ms | GC: 0.1ms)
  Rendered layout layouts/application.html.erb (Duration: 0.7ms | GC: 0.1ms)
Completed 200 OK in 2ms (Views: 1.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.6ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:55:56.629945', '2025-07-29 16:55:56.629945'), (298486374, NULL, '2025-07-29 16:55:56.629945', '2025-07-29 16:55:56.629945');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:55:56.631015', '2025-07-29 16:55:56.631015'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:55:56.631015', '2025-07-29 16:55:56.631015')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------------------
BulkChargeTest: test_should_save_bulk_charge_with_csv_file
----------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:55:56.651220"], ["updated_at", "2025-07-29 16:55:56.651220"]]
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "6g7w001eqq1a5gjsug455fmlchg0"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:55:56.678895"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:55:56.679782"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:56.681148"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 6g7w001eqq1a5gjsug455fmlchg0 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:56.691342"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-----------------------------------------------------------------
BulkChargeTest: test_should_not_save_bulk_charge_without_csv_file
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:55:56.694761"], ["updated_at", "2025-07-29 16:55:56.694761"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:55:56.717371"], ["updated_at", "2025-07-29 16:55:56.717371"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "w8bhfobt3nyn7htv6kqqoms9dayi"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:55:56.722162"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:55:56.722514"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:56.723287"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: w8bhfobt3nyn7htv6kqqoms9dayi (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:56.738146"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 16:55:56 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (0.2ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.7ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 17.0ms | GC: 10.6ms)
Completed 200 OK in 37ms (Views: 19.6ms | ActiveRecord: 0.2ms (1 query, 0 cached) | GC: 10.6ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:55:56.832031"], ["updated_at", "2025-07-29 16:55:56.832031"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ed18cgy1dr5hdzwmygk2ooqsosme"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:55:56.841011"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:55:56.843392"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:56.846079"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: ed18cgy1dr5hdzwmygk2ooqsosme (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (1.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:56.852198"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:55:56 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x00000001297367c8 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-77956-5y699m.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:55:56.860705"], ["updated_at", "2025-07-29 16:55:56.860705"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "6bh0j5bgwzmud33zqawbe9tf19go"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:55:56.864253"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 16:55:56.866982"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:56.867707"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: 6bh0j5bgwzmud33zqawbe9tf19go (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.4ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:56.872094"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.1ms) [0m[34mDownloaded file from key: 6bh0j5bgwzmud33zqawbe9tf19go[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 18ms (ActiveRecord: 1.0ms (10 queries, 0 cached) | GC: 0.4ms)
  [1m[36mBulkCharge Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.8ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:55:56.886818"], ["updated_at", "2025-07-29 16:55:56.886818"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "4abat5jrmpeb18td2lhq99e64pnv"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:55:56.896648"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:55:56.897446"]]
  [1m[36mBulkCharge Update (0.7ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:56.898383"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: 4abat5jrmpeb18td2lhq99e64pnv (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (3.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.9ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:56.908344"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:55:56 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.6ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 1.4ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 1.7ms | GC: 0.0ms)
Completed 200 OK in 3ms (Views: 1.6ms | ActiveRecord: 0.6ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.3ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:55:56.917882"], ["updated_at", "2025-07-29 16:55:56.917882"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "74a32ar0m40o4kj1hlsizsvz0l6n"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:55:56.928790"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:55:56.929573"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:56.929844"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: 74a32ar0m40o4kj1hlsizsvz0l6n (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:55:56.932886"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 16:55:56 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 1.5ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 2.9ms | GC: 0.0ms)
Completed 200 OK in 4ms (Views: 3.2ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------
PagesControllerTest: test_should_get_index
------------------------------------------
Started GET "/" for 127.0.0.1 at 2025-07-29 16:55:56 +0700
Processing by PagesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering pages/index.html.erb within layouts/application
  Rendered pages/index.html.erb within layouts/application (Duration: 0.3ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 0.5ms | GC: 0.0ms)
Completed 200 OK in 1ms (Views: 0.9ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.7ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:56:44.798312', '2025-07-29 16:56:44.798312'), (298486374, NULL, '2025-07-29 16:56:44.798312', '2025-07-29 16:56:44.798312');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:56:44.799636', '2025-07-29 16:56:44.799636'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:56:44.799636', '2025-07-29 16:56:44.799636')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------------------
BulkChargeTest: test_should_save_bulk_charge_with_csv_file
----------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:56:44.855247"], ["updated_at", "2025-07-29 16:56:44.855247"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "l5vh9hq79z7l69wxr5oc3jp7mbn1"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:56:44.861574"]]
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:56:44.862616"]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:56:44.864215"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: l5vh9hq79z7l69wxr5oc3jp7mbn1 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:56:44.887031"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-----------------------------------------------------------------
BulkChargeTest: test_should_not_save_bulk_charge_without_csv_file
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------
PagesControllerTest: test_should_get_index
------------------------------------------
Started GET "/" for 127.0.0.1 at 2025-07-29 16:56:44 +0700
Processing by PagesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering pages/index.html.erb within layouts/application
  Rendered pages/index.html.erb within layouts/application (Duration: 0.2ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 6.0ms | GC: 0.0ms)
Completed 200 OK in 17ms (Views: 8.3ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.7ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.2ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:57:52.314134', '2025-07-29 16:57:52.314134'), (298486374, NULL, '2025-07-29 16:57:52.314134', '2025-07-29 16:57:52.314134');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:57:52.315099', '2025-07-29 16:57:52.315099'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:57:52.315099', '2025-07-29 16:57:52.315099')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------------------
BulkChargeTest: test_should_save_bulk_charge_with_csv_file
----------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:57:52.342063"], ["updated_at", "2025-07-29 16:57:52.342063"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "2st3jq5gdzu77dka6k5puy23pi12"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:57:52.346827"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:57:52.347322"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:57:52.348316"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: 2st3jq5gdzu77dka6k5puy23pi12 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:57:52.358758"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-----------------------------------------------------------------
BulkChargeTest: test_should_not_save_bulk_charge_without_csv_file
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------
PagesControllerTest: test_should_get_index
------------------------------------------
Started GET "/" for 127.0.0.1 at 2025-07-29 16:57:52 +0700
Processing by PagesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering pages/index.html.erb within layouts/application
  Rendered pages/index.html.erb within layouts/application (Duration: 0.3ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 5.6ms | GC: 0.0ms)
Completed 200 OK in 22ms (Views: 8.2ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.5ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.2ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:58:42.824843', '2025-07-29 16:58:42.824843'), (298486374, NULL, '2025-07-29 16:58:42.824843', '2025-07-29 16:58:42.824843');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:58:42.826415', '2025-07-29 16:58:42.826415'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:58:42.826415', '2025-07-29 16:58:42.826415')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-----------------------------------------------------------------
BulkChargeTest: test_should_not_save_bulk_charge_without_csv_file
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------------------
BulkChargeTest: test_should_save_bulk_charge_with_csv_file
----------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:58:42.853132"], ["updated_at", "2025-07-29 16:58:42.853132"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "p11jl5restrjth3vhntl1d9u4yvq"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:58:42.858626"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:58:42.859090"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:58:42.860500"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: p11jl5restrjth3vhntl1d9u4yvq (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:58:42.870050"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:58:42.891439"], ["updated_at", "2025-07-29 16:58:42.891439"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "t7e3urf2vsrek8mfwf71bnqdo6i2"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:58:42.895410"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:58:42.895701"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:58:42.895958"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: t7e3urf2vsrek8mfwf71bnqdo6i2 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.4ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:58:42.902690"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 16:58:42 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 1.5ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 16.1ms | GC: 9.2ms)
Completed 200 OK in 32ms (Views: 18.3ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 9.2ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:58:42.994944"], ["updated_at", "2025-07-29 16:58:42.994944"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "vbgr9s5y3ojs48xdb2gte5toopi5"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:58:43.001983"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:58:43.003637"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:58:43.005804"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: vbgr9s5y3ojs48xdb2gte5toopi5 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:58:43.009321"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:58:43 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x000000011f5d28f0 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-78475-xycoyg.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:58:43.017263"], ["updated_at", "2025-07-29 16:58:43.017263"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "3v4myzpuhvs5xgraamuggov3moi8"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:58:43.019414"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 16:58:43.020284"]]
  [1m[36mBulkCharge Update (0.5ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:58:43.020525"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: 3v4myzpuhvs5xgraamuggov3moi8 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:58:43.024761"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.1ms) [0m[34mDownloaded file from key: 3v4myzpuhvs5xgraamuggov3moi8[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 16ms (ActiveRecord: 1.2ms (9 queries, 0 cached) | GC: 0.4ms)
  [1m[36mBulkCharge Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.2ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.5ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:58:43.046782"], ["updated_at", "2025-07-29 16:58:43.046782"]]
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "yypr75pbfs7xtyb6jo014k200lcz"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:58:43.051834"]]
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:58:43.053821"]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:58:43.055433"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: yypr75pbfs7xtyb6jo014k200lcz (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.8ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:58:43.061131"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:58:43 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.3ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 1.7ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 2.1ms | GC: 0.0ms)
Completed 200 OK in 4ms (Views: 2.4ms | ActiveRecord: 0.3ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.5ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:58:43.070631"], ["updated_at", "2025-07-29 16:58:43.070631"]]
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "os59rdbn13m66pxs4i79yxliokyg"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:58:43.073019"]]
  [1m[36mActiveStorage::Attachment Create (3.2ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:58:43.074072"]]
  [1m[36mBulkCharge Update (0.2ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:58:43.079538"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: os59rdbn13m66pxs4i79yxliokyg (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:58:43.086116"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 16:58:43 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (0.3ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.3ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 1.7ms | GC: 0.1ms)
Completed 200 OK in 7ms (Views: 2.0ms | ActiveRecord: 0.3ms (1 query, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------
PagesControllerTest: test_should_get_index
------------------------------------------
Started GET "/" for 127.0.0.1 at 2025-07-29 16:58:43 +0700
Processing by PagesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering pages/index.html.erb within layouts/application
  Rendered pages/index.html.erb within layouts/application (Duration: 0.4ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 0.7ms | GC: 0.0ms)
Completed 200 OK in 2ms (Views: 1.2ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.5ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:59:04.696537', '2025-07-29 16:59:04.696537'), (298486374, NULL, '2025-07-29 16:59:04.696537', '2025-07-29 16:59:04.696537');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:59:04.697462', '2025-07-29 16:59:04.697462'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:59:04.697462', '2025-07-29 16:59:04.697462')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:04.737677"], ["updated_at", "2025-07-29 16:59:04.737677"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dn9z8u0j9ltdd19ge9uz9v2r5g8d"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:04.742375"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:04.742851"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:04.743907"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: dn9z8u0j9ltdd19ge9uz9v2r5g8d (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:04.753707"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:59:04 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 0.9ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 6.7ms | GC: 0.0ms)
Completed 200 OK in 22ms (Views: 8.8ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:04.837101"], ["updated_at", "2025-07-29 16:59:04.837101"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "n8go3yue4ynud6cdmm5ksecvyhcq"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:04.841054"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:04.841627"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:04.841934"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: n8go3yue4ynud6cdmm5ksecvyhcq (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:04.848924"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:59:04 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x0000000121b83680 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-78571-h784tk.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:04.870786"], ["updated_at", "2025-07-29 16:59:04.870786"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "2ket1cdxeyhatj3nzvz51ew1z2h1"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:04.876591"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 16:59:04.878187"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:04.880526"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: 2ket1cdxeyhatj3nzvz51ew1z2h1 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:04.883759"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.1ms) [0m[34mDownloaded file from key: 2ket1cdxeyhatj3nzvz51ew1z2h1[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 24ms (ActiveRecord: 0.4ms (9 queries, 0 cached) | GC: 0.7ms)
  [1m[36mBulkCharge Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.2ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:04.900773"], ["updated_at", "2025-07-29 16:59:04.900773"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "an8tinljt9zrvsz3niq9d3ql4szn"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:04.903414"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:04.904469"]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:04.905418"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: an8tinljt9zrvsz3niq9d3ql4szn (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:04.910688"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 16:59:04 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (0.3ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.7ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 0.9ms | GC: 0.0ms)
Completed 200 OK in 7ms (Views: 1.2ms | ActiveRecord: 0.3ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.3ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:04.924612"], ["updated_at", "2025-07-29 16:59:04.924612"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "wzv38oy4fo9rxtaksu9qwb4yunut"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:04.928543"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:04.929617"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:04.930536"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: wzv38oy4fo9rxtaksu9qwb4yunut (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:04.935830"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 16:59:04 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 1.3ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 2.6ms | GC: 0.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------
PagesControllerTest: test_should_get_index
------------------------------------------
Started GET "/" for 127.0.0.1 at 2025-07-29 16:59:04 +0700
Processing by PagesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering pages/index.html.erb within layouts/application
  Rendered pages/index.html.erb within layouts/application (Duration: 0.3ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 0.5ms | GC: 0.0ms)
Completed 200 OK in 1ms (Views: 0.9ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-----------------------------------------------------------------
BulkChargeTest: test_should_not_save_bulk_charge_without_csv_file
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------------------
BulkChargeTest: test_should_save_bulk_charge_with_csv_file
----------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.3ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:04.949492"], ["updated_at", "2025-07-29 16:59:04.949492"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (2.4ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "6thl9sljyjqsq1bbflx9uggo81id"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:04.951075"]]
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:04.954557"]]
  [1m[36mBulkCharge Update (0.5ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:04.956395"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: 6thl9sljyjqsq1bbflx9uggo81id (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:04.961638"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkChargeTest: test_should_validate_presence_of_csv_file
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.5ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:59:07.833640', '2025-07-29 16:59:07.833640'), (298486374, NULL, '2025-07-29 16:59:07.833640', '2025-07-29 16:59:07.833640');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:59:07.834980', '2025-07-29 16:59:07.834980'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:59:07.834980', '2025-07-29 16:59:07.834980')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-----------------------------------------------------------------
BulkChargeTest: test_should_not_save_bulk_charge_without_csv_file
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkChargeTest: test_should_validate_presence_of_csv_file
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------------------
BulkChargeTest: test_should_save_bulk_charge_with_csv_file
----------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:07.858341"], ["updated_at", "2025-07-29 16:59:07.858341"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "o4dfiryq0h5aoucxhakizhuytbqs"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:07.862645"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:07.863129"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:07.864571"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: o4dfiryq0h5aoucxhakizhuytbqs (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:07.873147"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:07.889739"], ["updated_at", "2025-07-29 16:59:07.889739"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "avbsu9ys0mlc9vxmg8h682xe9lfk"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:07.894051"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:07.894397"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:07.894707"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: avbsu9ys0mlc9vxmg8h682xe9lfk (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:07.907736"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 16:59:07 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 1.0ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 14.3ms | GC: 9.5ms)
Completed 200 OK in 23ms (Views: 16.4ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 9.5ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:07.977451"], ["updated_at", "2025-07-29 16:59:07.977451"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "2qs871gu6u2qeegrmetpl5ackkwj"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:07.982967"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:07.984347"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:07.986807"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: 2qs871gu6u2qeegrmetpl5ackkwj (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:07.991104"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 16:59:07 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.6ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 0.8ms | GC: 0.0ms)
Completed 200 OK in 5ms (Views: 1.0ms | ActiveRecord: 0.0ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:08.002112"], ["updated_at", "2025-07-29 16:59:08.002112"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "2h473gzqdo501pgoyo6o3t1qcv3w"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:08.003870"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:08.004748"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:08.005005"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: 2h473gzqdo501pgoyo6o3t1qcv3w (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.2ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:08.008475"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:59:08 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x000000011fcd37a8 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-78602-c48gwl.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (1.4ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:08.016905"], ["updated_at", "2025-07-29 16:59:08.016905"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "7isaaydyyyy1ei6l93mj74jw6ssw"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:08.022110"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 16:59:08.023279"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:08.024328"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: 7isaaydyyyy1ei6l93mj74jw6ssw (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:08.028072"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.1ms) [0m[34mDownloaded file from key: 7isaaydyyyy1ei6l93mj74jw6ssw[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 20ms (ActiveRecord: 2.2ms (9 queries, 0 cached) | GC: 0.4ms)
  [1m[36mBulkCharge Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.3ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:08.042287"], ["updated_at", "2025-07-29 16:59:08.042287"]]
  [1m[36mActiveStorage::Attachment Load (2.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.8ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "v5f0wypnvi4u1cf1gwev055dbsc0"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:08.046787"]]
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:08.048735"]]
  [1m[36mBulkCharge Update (0.2ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:08.049473"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: v5f0wypnvi4u1cf1gwev055dbsc0 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:08.053902"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:59:08 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.4ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 1.0ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 2.4ms | GC: 0.1ms)
Completed 200 OK in 3ms (Views: 2.5ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------
PagesControllerTest: test_should_get_index
------------------------------------------
Started GET "/" for 127.0.0.1 at 2025-07-29 16:59:08 +0700
Processing by PagesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering pages/index.html.erb within layouts/application
  Rendered pages/index.html.erb within layouts/application (Duration: 0.3ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 0.6ms | GC: 0.0ms)
Completed 200 OK in 1ms (Views: 1.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.7ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:59:24.779280', '2025-07-29 16:59:24.779280'), (298486374, NULL, '2025-07-29 16:59:24.779280', '2025-07-29 16:59:24.779280');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:59:24.780253', '2025-07-29 16:59:24.780253'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:59:24.780253', '2025-07-29 16:59:24.780253')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------
PagesControllerTest: test_should_get_index
------------------------------------------
Started GET "/" for 127.0.0.1 at 2025-07-29 16:59:24 +0700
Processing by PagesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering pages/index.html.erb within layouts/application
  Rendered pages/index.html.erb within layouts/application (Duration: 0.3ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 5.9ms | GC: 0.0ms)
Completed 200 OK in 23ms (Views: 8.6ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-----------------------------------------------------------------
BulkChargeTest: test_should_not_save_bulk_charge_without_csv_file
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------------
BulkChargeTest: test_should_have_one_attached_csv_file
------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkChargeTest: test_should_validate_presence_of_csv_file
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------------------
BulkChargeTest: test_should_save_bulk_charge_with_csv_file
----------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:24.898711"], ["updated_at", "2025-07-29 16:59:24.898711"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "2yclylfls7iritp7sw46ftvl02n1"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:24.903902"]]
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:24.904816"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:24.905877"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: 2yclylfls7iritp7sw46ftvl02n1 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:24.916342"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.3ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:24.929918"], ["updated_at", "2025-07-29 16:59:24.929918"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "9qxfnyr8oe4auiz1d23fgwrfy948"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:24.938957"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:24.940648"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:24.942331"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: 9qxfnyr8oe4auiz1d23fgwrfy948 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:24.953341"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:59:24 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 1.2ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 1.4ms | GC: 0.0ms)
Completed 200 OK in 3ms (Views: 1.8ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:24.970579"], ["updated_at", "2025-07-29 16:59:24.970579"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s2c36pdkyh5owxki1805mood4teh"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:24.972564"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:24.972884"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:24.973984"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: s2c36pdkyh5owxki1805mood4teh (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.6ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.2ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:24.978403"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:59:24 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x0000000116979610 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-78673-9i64v6.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:24.985587"], ["updated_at", "2025-07-29 16:59:24.985587"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "5jj6l8ivklfnej6o1sci24pvf8ek"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:24.988453"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 16:59:24.989740"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:24.990523"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: 5jj6l8ivklfnej6o1sci24pvf8ek (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:24.995511"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.1ms) [0m[34mDownloaded file from key: 5jj6l8ivklfnej6o1sci24pvf8ek[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 19ms (ActiveRecord: 0.7ms (9 queries, 0 cached) | GC: 0.5ms)
  [1m[36mBulkCharge Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.3ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:25.011962"], ["updated_at", "2025-07-29 16:59:25.011962"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "efj7vzi7x9f3143ctbw1qcgwj3vn"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:25.015783"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:25.017624"]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:25.018139"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: efj7vzi7x9f3143ctbw1qcgwj3vn (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.2ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:25.022644"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 16:59:25 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (3.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.6ms | GC: 0.2ms)
  Rendered layout layouts/application.html.erb (Duration: 0.9ms | GC: 0.2ms)
Completed 200 OK in 10ms (Views: 1.6ms | ActiveRecord: 2.4ms (1 query, 0 cached) | GC: 0.4ms)
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.4ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:25.039718"], ["updated_at", "2025-07-29 16:59:25.039718"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "njuru5vgw0u2d2ucow442nlwkyje"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:25.041902"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:25.042451"]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:25.042960"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: njuru5vgw0u2d2ucow442nlwkyje (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:25.046851"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 16:59:25 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 3.1ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 3.6ms | GC: 0.0ms)
Completed 200 OK in 5ms (Views: 3.9ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.5ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 16:59:30.694961', '2025-07-29 16:59:30.694961'), (298486374, NULL, '2025-07-29 16:59:30.694961', '2025-07-29 16:59:30.694961');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:59:30.695973', '2025-07-29 16:59:30.695973'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 16:59:30.695973', '2025-07-29 16:59:30.695973')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:30.734592"], ["updated_at", "2025-07-29 16:59:30.734592"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "wqtakiacccwigzrpp5uthla4z3ye"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:30.739095"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:30.739610"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:30.740596"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: wqtakiacccwigzrpp5uthla4z3ye (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:30.750358"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:59:30 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x0000000122822300 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-78702-3hty6h.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:30.806359"], ["updated_at", "2025-07-29 16:59:30.806359"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "79vqybya6lr0eumyxx97kqhmskf9"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:30.810004"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 16:59:30.810330"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:30.810686"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: 79vqybya6lr0eumyxx97kqhmskf9 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:30.816533"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (9.0ms) [0m[34mDownloaded file from key: 79vqybya6lr0eumyxx97kqhmskf9[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 36ms (ActiveRecord: 0.6ms (9 queries, 0 cached) | GC: 8.8ms)
  [1m[36mBulkCharge Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:30.848508"], ["updated_at", "2025-07-29 16:59:30.848508"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "nmr7b2r6uchfk3f40eqxfxzs4sai"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:30.855432"]]
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:30.857495"]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:30.860653"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: nmr7b2r6uchfk3f40eqxfxzs4sai (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:30.870948"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 16:59:30 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 1.9ms | GC: 0.2ms)
  Rendered layout layouts/application.html.erb (Duration: 5.8ms | GC: 0.4ms)
Completed 200 OK in 16ms (Views: 7.9ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.6ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.4ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:30.894728"], ["updated_at", "2025-07-29 16:59:30.894728"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "2boatvja8bqv4idx3wlnn7tbw33k"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:30.897282"]]
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:30.897978"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:30.898838"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: 2boatvja8bqv4idx3wlnn7tbw33k (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.6ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:30.903415"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 16:59:30 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.7ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 1.0ms | GC: 0.0ms)
Completed 200 OK in 6ms (Views: 1.2ms | ActiveRecord: 0.0ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:30.915548"], ["updated_at", "2025-07-29 16:59:30.915548"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "wk5key015szldpkjaln7svyr5ze2"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:30.919724"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:30.921713"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:30.923179"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: wk5key015szldpkjaln7svyr5ze2 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:30.931643"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 16:59:30 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 3.2ms | GC: 2.3ms)
  Rendered layout layouts/application.html.erb (Duration: 4.5ms | GC: 2.3ms)
Completed 200 OK in 5ms (Views: 4.9ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 2.3ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------------
BulkChargeTest: test_should_have_one_attached_csv_file
------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------------------
BulkChargeTest: test_should_save_bulk_charge_with_csv_file
----------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.9ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 16:59:30.948847"], ["updated_at", "2025-07-29 16:59:30.948847"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "r7maxgdoz3lzncugq1u5f1ry7jim"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 16:59:30.952473"]]
  [1m[36mActiveStorage::Attachment Create (0.8ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 16:59:30.953120"]]
  [1m[36mBulkCharge Update (1.9ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:30.954367"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: r7maxgdoz3lzncugq1u5f1ry7jim (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.4ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 16:59:30.964362"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkChargeTest: test_should_validate_presence_of_csv_file
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-----------------------------------------------------------------
BulkChargeTest: test_should_not_save_bulk_charge_without_csv_file
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------
PagesControllerTest: test_should_get_index
------------------------------------------
Started GET "/" for 127.0.0.1 at 2025-07-29 16:59:30 +0700
Processing by PagesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering pages/index.html.erb within layouts/application
  Rendered pages/index.html.erb within layouts/application (Duration: 0.4ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 0.8ms | GC: 0.0ms)
Completed 200 OK in 4ms (Views: 2.9ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 1.6ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.8ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.3ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 17:00:09.132106', '2025-07-29 17:00:09.132106'), (298486374, NULL, '2025-07-29 17:00:09.132106', '2025-07-29 17:00:09.132106');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 17:00:09.133023', '2025-07-29 17:00:09.133023'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 17:00:09.133023', '2025-07-29 17:00:09.133023')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:00:09.174266"], ["updated_at", "2025-07-29 17:00:09.174266"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ewcmcfs6s336jl4c0xg6v9sk9drq"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:00:09.179037"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:00:09.179513"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:00:09.180508"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: ewcmcfs6s336jl4c0xg6v9sk9drq (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:00:09.190375"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 17:00:09 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.3ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 5.5ms | GC: 0.0ms)
Completed 200 OK in 23ms (Views: 8.0ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:00:09.266164"], ["updated_at", "2025-07-29 17:00:09.266164"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "1hs97naquvz1reefvf1ue5tritw4"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:00:09.269722"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:00:09.270020"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:00:09.270665"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: 1hs97naquvz1reefvf1ue5tritw4 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:00:09.276486"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 17:00:09 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x0000000122059100 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-78826-zibpwl.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:00:09.302522"], ["updated_at", "2025-07-29 17:00:09.302522"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "z0nga4s4yhyobtamkze0wms20mlr"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:00:09.306814"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 17:00:09.308023"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:00:09.310180"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: z0nga4s4yhyobtamkze0wms20mlr (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:00:09.313494"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.1ms) [0m[34mDownloaded file from key: z0nga4s4yhyobtamkze0wms20mlr[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 31ms (ActiveRecord: 0.4ms (9 queries, 0 cached) | GC: 11.0ms)
  [1m[36mBulkCharge Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.2ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:00:09.328687"], ["updated_at", "2025-07-29 17:00:09.328687"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "5lgxhzxvpio36nv0b227obwiaxki"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:00:09.331046"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:00:09.332055"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:00:09.333292"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: 5lgxhzxvpio36nv0b227obwiaxki (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:00:09.338400"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 17:00:09 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 2.1ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 2.3ms | GC: 0.0ms)
Completed 200 OK in 3ms (Views: 2.6ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:00:09.349145"], ["updated_at", "2025-07-29 17:00:09.349145"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ounhc7bbdeqvct6y1v5bye1pca5b"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:00:09.353326"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:00:09.354693"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:00:09.355418"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: ounhc7bbdeqvct6y1v5bye1pca5b (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:00:09.360975"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 17:00:09 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 0.9ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 2.1ms | GC: 0.0ms)
Completed 200 OK in 3ms (Views: 2.5ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.2ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------
ChargeResultTest: test_should_belong_to_bulk_charge
---------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------
PagesControllerTest: test_should_get_index
------------------------------------------
Started GET "/" for 127.0.0.1 at 2025-07-29 17:00:09 +0700
Processing by PagesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering pages/index.html.erb within layouts/application
  Rendered pages/index.html.erb within layouts/application (Duration: 0.4ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 0.6ms | GC: 0.0ms)
Completed 200 OK in 2ms (Views: 1.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkChargeTest: test_should_validate_presence_of_csv_file
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------------
BulkChargeTest: test_should_have_one_attached_csv_file
------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------------------
BulkChargeTest: test_should_save_bulk_charge_with_csv_file
----------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (1.6ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:00:09.379293"], ["updated_at", "2025-07-29 17:00:09.379293"]]
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "lxz3r2vr5ogkgzt76w1qr40gjgnc"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:00:09.383740"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:00:09.384134"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:00:09.384549"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: lxz3r2vr5ogkgzt76w1qr40gjgnc (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:00:09.387234"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-----------------------------------------------------------------
BulkChargeTest: test_should_not_save_bulk_charge_without_csv_file
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.6ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 17:01:54.831706', '2025-07-29 17:01:54.831706'), (298486374, NULL, '2025-07-29 17:01:54.831706', '2025-07-29 17:01:54.831706');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 17:01:54.832879', '2025-07-29 17:01:54.832879'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 17:01:54.832879', '2025-07-29 17:01:54.832879')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------
PagesControllerTest: test_should_get_index
------------------------------------------
Started GET "/" for 127.0.0.1 at 2025-07-29 17:01:54 +0700
Processing by PagesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering pages/index.html.erb within layouts/application
  Rendered pages/index.html.erb within layouts/application (Duration: 0.2ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 5.4ms | GC: 0.0ms)
Completed 200 OK in 22ms (Views: 7.9ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkChargeTest: test_should_validate_presence_of_csv_file
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------------
BulkChargeTest: test_should_have_one_attached_csv_file
------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-----------------------------------------------------------------
BulkChargeTest: test_should_not_save_bulk_charge_without_csv_file
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------------------
BulkChargeTest: test_should_save_bulk_charge_with_csv_file
----------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:01:54.956510"], ["updated_at", "2025-07-29 17:01:54.956510"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "zlio7069u1iiwc7wqbmhn2e4gcu3"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:01:54.961726"]]
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:01:54.962632"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:01:54.963714"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: zlio7069u1iiwc7wqbmhn2e4gcu3 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:01:54.973909"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------
ChargeResultTest: test_should_belong_to_bulk_charge
---------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:01:54.987965"], ["updated_at", "2025-07-29 17:01:54.987965"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "9nrr0snu505bhi516l06vut72kn7"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:01:54.996624"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:01:54.998441"]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:01:55.000128"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: 9nrr0snu505bhi516l06vut72kn7 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:01:55.011087"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mChargeResult Create (0.1ms)[0m  [1m[32mINSERT INTO "charge_results" ("bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["bulk_charge_id", 980190963], ["row_number", nil], ["status", nil], ["omise_charge_id", nil], ["token_response", "[FILTERED]"], ["charge_response", nil], ["created_at", "2025-07-29 17:01:55.018074"], ["updated_at", "2025-07-29 17:01:55.018074"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:01:55.023204"], ["updated_at", "2025-07-29 17:01:55.023204"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "9ztakdi0no5r47udozwl1s4bdyz8"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:01:55.025038"]]
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:01:55.026755"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:01:55.027661"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: 9ztakdi0no5r47udozwl1s4bdyz8 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.6ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:01:55.031471"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 17:01:55 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (0.2ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.6ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 0.9ms | GC: 0.0ms)
Completed 200 OK in 6ms (Views: 1.3ms | ActiveRecord: 0.2ms (1 query, 0 cached) | GC: 0.3ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:01:55.046935"], ["updated_at", "2025-07-29 17:01:55.046935"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "568o6a4a8rlomdaf4h9lw8vkwflx"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:01:55.049286"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:01:55.049776"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:01:55.050375"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: 568o6a4a8rlomdaf4h9lw8vkwflx (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.5ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:01:55.056240"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 17:01:55 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x0000000129e12218 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-79132-dn2vh2.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:01:55.067043"], ["updated_at", "2025-07-29 17:01:55.067043"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "uyhm935uazgfle3muumdfwzh3zb2"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:01:55.069409"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 17:01:55.069984"]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:01:55.070839"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: uyhm935uazgfle3muumdfwzh3zb2 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.3ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:01:55.074216"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.1ms) [0m[34mDownloaded file from key: uyhm935uazgfle3muumdfwzh3zb2[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 15ms (ActiveRecord: 0.9ms (9 queries, 0 cached) | GC: 0.2ms)
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (2.8ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.4ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:01:55.092595"], ["updated_at", "2025-07-29 17:01:55.092595"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "fgxkyxt27fbbor5e40y8ja8g03d9"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:01:55.094877"]]
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:01:55.095430"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:01:55.096388"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: fgxkyxt27fbbor5e40y8ja8g03d9 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:01:55.099023"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 17:01:55 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 0.8ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 1.1ms | GC: 0.0ms)
Completed 200 OK in 2ms (Views: 1.6ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:01:55.104802"], ["updated_at", "2025-07-29 17:01:55.104802"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "nr34etbq3m19bgqzxfaru8svoich"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:01:55.106433"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:01:55.106743"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:01:55.107843"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: nr34etbq3m19bgqzxfaru8svoich (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:01:55.113882"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 17:01:55 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 5.9ms | GC: 1.3ms)
  Rendered layout layouts/application.html.erb (Duration: 7.0ms | GC: 1.9ms)
Completed 200 OK in 10ms (Views: 8.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 3.9ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.5ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 17:02:08.035768', '2025-07-29 17:02:08.035768'), (298486374, NULL, '2025-07-29 17:02:08.035768', '2025-07-29 17:02:08.035768');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 17:02:08.036903', '2025-07-29 17:02:08.036903'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 17:02:08.036903', '2025-07-29 17:02:08.036903')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkChargeTest: test_should_validate_presence_of_csv_file
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------------
BulkChargeTest: test_should_have_one_attached_csv_file
------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------------------
BulkChargeTest: test_should_save_bulk_charge_with_csv_file
----------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:02:08.063097"], ["updated_at", "2025-07-29 17:02:08.063097"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "2g9fu54q4778pyf3t6r8jeb50amv"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:02:08.071009"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:02:08.071811"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:02:08.072995"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: 2g9fu54q4778pyf3t6r8jeb50amv (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:02:08.083510"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-----------------------------------------------------------------
BulkChargeTest: test_should_not_save_bulk_charge_without_csv_file
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------
ChargeResultTest: test_should_belong_to_bulk_charge
---------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:02:08.089355"], ["updated_at", "2025-07-29 17:02:08.089355"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "rcna97fdbdkf3y3kat7y7p9axrur"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:02:08.094346"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:02:08.099932"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:02:08.101555"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: rcna97fdbdkf3y3kat7y7p9axrur (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:02:08.115809"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mChargeResult Create (0.2ms)[0m  [1m[32mINSERT INTO "charge_results" ("bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["bulk_charge_id", 980190963], ["row_number", nil], ["status", nil], ["omise_charge_id", nil], ["token_response", "[FILTERED]"], ["charge_response", nil], ["created_at", "2025-07-29 17:02:08.129193"], ["updated_at", "2025-07-29 17:02:08.129193"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------------
ChargeResultTest: test_should_validate_presence_of_row_number
-------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------
PagesControllerTest: test_should_get_index
------------------------------------------
Started GET "/" for 127.0.0.1 at 2025-07-29 17:02:08 +0700
Processing by PagesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering pages/index.html.erb within layouts/application
  Rendered pages/index.html.erb within layouts/application (Duration: 0.2ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 6.2ms | GC: 0.0ms)
Completed 200 OK in 23ms (Views: 8.4ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:02:08.241022"], ["updated_at", "2025-07-29 17:02:08.241022"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "f1l5bfnd4d1zm0qddndtwc4st66m"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:02:08.243908"]]
  [1m[36mActiveStorage::Attachment Create (0.6ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:02:08.246075"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:02:08.247243"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: f1l5bfnd4d1zm0qddndtwc4st66m (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:02:08.251590"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 17:02:08 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.6ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 0.9ms | GC: 0.0ms)
Completed 200 OK in 5ms (Views: 1.3ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:02:08.264248"], ["updated_at", "2025-07-29 17:02:08.264248"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "jlwc49wjl8mfboktq9ylcyefdnq9"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:02:08.267517"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:02:08.267991"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:02:08.268500"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: jlwc49wjl8mfboktq9ylcyefdnq9 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:02:08.273799"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 17:02:08 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x00000001381be160 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-79192-i22sm3.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:02:08.283963"], ["updated_at", "2025-07-29 17:02:08.283963"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "7fjaspvtfxijtpahxlkd1mbbhgdt"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:02:08.286194"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 17:02:08.286720"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:02:08.287305"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: 7fjaspvtfxijtpahxlkd1mbbhgdt (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.2ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:02:08.290583"], ["id", 980190964]]
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.1ms) [0m[34mDownloaded file from key: 7fjaspvtfxijtpahxlkd1mbbhgdt[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 17ms (ActiveRecord: 1.7ms (9 queries, 0 cached) | GC: 0.0ms)
  [1m[36mBulkCharge Count (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.8ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.3ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:02:08.310009"], ["updated_at", "2025-07-29 17:02:08.310009"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "y5howp4spbpu3hrp925dh28rt7pn"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:02:08.312369"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:02:08.312876"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:02:08.313756"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: y5howp4spbpu3hrp925dh28rt7pn (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:02:08.316795"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 17:02:08 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 1.3ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 2.4ms | GC: 0.0ms)
Completed 200 OK in 3ms (Views: 2.9ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:02:08.323462"], ["updated_at", "2025-07-29 17:02:08.323462"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "9fm8xm23tlpjx67079m8cpdtfity"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:02:08.324621"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:02:08.325662"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:02:08.326600"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: 9fm8xm23tlpjx67079m8cpdtfity (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:02:08.329194"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 17:02:08 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 0.7ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 1.0ms | GC: 0.0ms)
Completed 200 OK in 2ms (Views: 1.1ms | ActiveRecord: 0.0ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.5ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 17:03:04.650475', '2025-07-29 17:03:04.650475'), (298486374, NULL, '2025-07-29 17:03:04.650475', '2025-07-29 17:03:04.650475');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 17:03:04.651525', '2025-07-29 17:03:04.651525'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 17:03:04.651525', '2025-07-29 17:03:04.651525')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:03:04.691101"], ["updated_at", "2025-07-29 17:03:04.691101"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "hlslw0sslvhte3gqexmag3nbkffn"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:03:04.696073"]]
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:03:04.696707"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:03:04.697879"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: hlslw0sslvhte3gqexmag3nbkffn (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:03:04.708129"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 17:03:04 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 1.4ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 6.5ms | GC: 0.0ms)
Completed 200 OK in 23ms (Views: 8.9ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:03:04.791391"], ["updated_at", "2025-07-29 17:03:04.791391"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "tf5xcp1cl3yr5amkui3ks2cpkls8"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:03:04.794924"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:03:04.795310"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:03:04.795873"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: tf5xcp1cl3yr5amkui3ks2cpkls8 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:03:04.801647"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 17:03:04 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x0000000120884a70 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-79463-mnmaj.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:03:04.817042"], ["updated_at", "2025-07-29 17:03:04.817042"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "bas3julkfo6o3ecgylihupnxcvzi"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:03:04.823116"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 17:03:04.824531"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:03:04.826788"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: bas3julkfo6o3ecgylihupnxcvzi (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:03:04.834948"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.1ms) [0m[34mDownloaded file from key: bas3julkfo6o3ecgylihupnxcvzi[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 33ms (ActiveRecord: 0.4ms (9 queries, 0 cached) | GC: 0.6ms)
  [1m[36mBulkCharge Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (2.0ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:03:04.874761"], ["updated_at", "2025-07-29 17:03:04.874761"]]
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "l0gyjqil8k0or32c8945l349949j"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:03:04.887999"]]
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:03:04.892842"]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:03:04.894012"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: l0gyjqil8k0or32c8945l349949j (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.8ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:03:04.904491"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 17:03:04 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.2ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 1.6ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 2.0ms | GC: 0.0ms)
Completed 200 OK in 3ms (Views: 2.1ms | ActiveRecord: 0.2ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:03:04.923645"], ["updated_at", "2025-07-29 17:03:04.923645"]]
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "aj58389gdbdd2dlaytjrxaf3obao"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:03:04.929008"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:03:04.930895"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:03:04.932023"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: aj58389gdbdd2dlaytjrxaf3obao (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.4ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:03:04.938644"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 17:03:04 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.3ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 1.6ms | GC: 0.0ms)
Completed 200 OK in 7ms (Views: 2.0ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------
ChargeResultTest: test_should_belong_to_bulk_charge
---------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.5ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:03:04.951001"], ["updated_at", "2025-07-29 17:03:04.951001"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "7c5wfn4sbbzsmaylcxqzaiu1ltre"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:03:04.952843"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:03:04.953278"]]
  [1m[36mBulkCharge Update (0.2ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:03:04.953835"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: 7c5wfn4sbbzsmaylcxqzaiu1ltre (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (2.7ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.3ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:03:04.960797"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mChargeResult Create (0.5ms)[0m  [1m[32mINSERT INTO "charge_results" ("bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["bulk_charge_id", 980190963], ["row_number", nil], ["status", nil], ["omise_charge_id", nil], ["token_response", "[FILTERED]"], ["charge_response", nil], ["created_at", "2025-07-29 17:03:04.965419"], ["updated_at", "2025-07-29 17:03:04.965419"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------------------
BulkChargeTest: test_should_save_bulk_charge_with_csv_file
----------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:03:04.971899"], ["updated_at", "2025-07-29 17:03:04.971899"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "te3tzxvxefii43okiwsg59nwjiui"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:03:04.973374"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:03:04.973801"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:03:04.974629"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: te3tzxvxefii43okiwsg59nwjiui (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:03:04.977146"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------------
BulkChargeTest: test_should_have_one_attached_csv_file
------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-----------------------------------------------------------------
BulkChargeTest: test_should_not_save_bulk_charge_without_csv_file
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkChargeTest: test_should_validate_presence_of_csv_file
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------
PagesControllerTest: test_should_get_index
------------------------------------------
Started GET "/" for 127.0.0.1 at 2025-07-29 17:03:04 +0700
Processing by PagesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering pages/index.html.erb within layouts/application
  Rendered pages/index.html.erb within layouts/application (Duration: 0.3ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 0.5ms | GC: 0.0ms)
Completed 200 OK in 1ms (Views: 1.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35mSQL (1.6ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35mSQL (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mFixtures Load (0.2ms)[0m  [1m[31mDELETE FROM "bulk_charges";
DELETE FROM "charge_results";
INSERT INTO "bulk_charges" ("id", "status", "created_at", "updated_at") VALUES (980190962, NULL, '2025-07-29 17:04:36.865794', '2025-07-29 17:04:36.865794'), (298486374, NULL, '2025-07-29 17:04:36.865794', '2025-07-29 17:04:36.865794');
INSERT INTO "charge_results" ("id", "bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (980190962, 980190962, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 17:04:36.867399', '2025-07-29 17:04:36.867399'), (298486374, 298486374, 1, 'MyString', 'MyString', NULL, NULL, '2025-07-29 17:04:36.867399', '2025-07-29 17:04:36.867399')[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_key_check[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-----------------------------------------------------------------
BulkChargeTest: test_should_not_save_bulk_charge_without_csv_file
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------------
BulkChargeTest: test_should_have_one_attached_csv_file
------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkChargeTest: test_should_validate_presence_of_csv_file
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------------------
BulkChargeTest: test_should_save_bulk_charge_with_csv_file
----------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.1ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:04:36.897469"], ["updated_at", "2025-07-29 17:04:36.897469"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "olkpky72piln99rn9fsnxp04iom7"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:04:36.902768"]]
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:04:36.904071"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:04:36.905279"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: olkpky72piln99rn9fsnxp04iom7 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:04:36.915635"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------
PagesControllerTest: test_should_get_index
------------------------------------------
Started GET "/" for 127.0.0.1 at 2025-07-29 17:04:36 +0700
Processing by PagesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering pages/index.html.erb within layouts/application
  Rendered pages/index.html.erb within layouts/application (Duration: 0.2ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 14.9ms | GC: 9.2ms)
Completed 200 OK in 31ms (Views: 17.4ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 9.2ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------
BulkchargesControllerTest: test_should_get_index
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.3ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:04:37.019218"], ["updated_at", "2025-07-29 17:04:37.019218"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "kcu8qw3m7j0es7arh19ye6kjoj3i"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:04:37.029423"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:04:37.031264"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:04:37.032964"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: kcu8qw3m7j0es7arh19ye6kjoj3i (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:04:37.044515"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges" for 127.0.0.1 at 2025-07-29 17:04:37 +0700
Processing by BulkchargesController#index as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/index.html.erb within layouts/application
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."created_at" DESC[0m
  Rendered bulkcharges/index.html.erb within layouts/application (Duration: 1.1ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 1.2ms | GC: 0.0ms)
Completed 200 OK in 2ms (Views: 1.6ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------
BulkchargesControllerTest: test_should_create_bulk_charge
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:04:37.060804"], ["updated_at", "2025-07-29 17:04:37.060804"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "b8u03bj7llsl2g3fvet2k00ul6wr"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:04:37.062968"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:04:37.063228"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:04:37.064298"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: b8u03bj7llsl2g3fvet2k00ul6wr (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.6ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.2ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:04:37.068939"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
Started POST "/bulkcharges" for 127.0.0.1 at 2025-07-29 17:04:37 +0700
Processing by BulkchargesController#create as HTML
  Parameters: {"bulk_charge"=>{"csv_file"=>#<ActionDispatch::Http::UploadedFile:0x00000001254b3720 @tempfile=#<Tempfile:/var/folders/b2/xv60d1ms7qs6dlygj1mdc1wm0000gp/T/RackMultipart20250729-79817-o0h3rf.csv>, @content_type="text/csv", @original_filename="bulk-exercise.csv", @headers="content-disposition: form-data; name=\"bulk_charge[csv_file]\"; filename=\"bulk-exercise.csv\"\r\ncontent-type: text/csv\r\ncontent-length: 106\r\n">}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:04:37.076700"], ["updated_at", "2025-07-29 17:04:37.076700"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190964], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "81dyo5x19aihqezt6e92un87nxb9"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:04:37.079395"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190964], ["blob_id", 2], ["created_at", "2025-07-29 17:04:37.080336"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:04:37.081010"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: 81dyo5x19aihqezt6e92un87nxb9 (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190964]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:04:37.085971"], ["id", 980190964]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.1ms) [0m[34mDownloaded file from key: 81dyo5x19aihqezt6e92un87nxb9[0m
Redirected to http://www.example.com/bulkcharges/980190964
Completed 302 Found in 19ms (ActiveRecord: 0.7ms (9 queries, 0 cached) | GC: 0.4ms)
  [1m[36mBulkCharge Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "bulk_charges"[0m
  [1m[36mBulkCharge Load (0.1ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" ORDER BY "bulk_charges"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-------------------------------------------------------
BulkchargesControllerTest: test_should_show_bulk_charge
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:04:37.102835"], ["updated_at", "2025-07-29 17:04:37.102835"]]
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "96svnlc683y1ug56yfjztg2jfbby"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:04:37.106242"]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:04:37.107909"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:04:37.108385"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 96svnlc683y1ug56yfjztg2jfbby (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.2ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:04:37.112593"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/980190963" for 127.0.0.1 at 2025-07-29 17:04:37 +0700
Processing by BulkchargesController#show as HTML
  Parameters: {"id"=>"980190963"}
  [1m[36mBulkCharge Load (2.3ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/show.html.erb within layouts/application
  Rendered bulkcharges/show.html.erb within layouts/application (Duration: 0.4ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 0.7ms | GC: 0.0ms)
Completed 200 OK in 8ms (Views: 1.3ms | ActiveRecord: 1.7ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------
BulkchargesControllerTest: test_should_get_new
----------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.4ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:04:37.126897"], ["updated_at", "2025-07-29 17:04:37.126897"]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "j5nre4vil0b7zqzphshu9mx8p3vx"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:04:37.129345"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:04:37.129867"]]
  [1m[36mBulkCharge Update (0.1ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:04:37.130301"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: j5nre4vil0b7zqzphshu9mx8p3vx (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:04:37.133321"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/bulkcharges/new" for 127.0.0.1 at 2025-07-29 17:04:37 +0700
Processing by BulkchargesController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering bulkcharges/new.html.erb within layouts/application
  Rendered bulkcharges/new.html.erb within layouts/application (Duration: 2.8ms | GC: 0.0ms)
  Rendered layout layouts/application.html.erb (Duration: 3.2ms | GC: 0.0ms)
Completed 200 OK in 4ms (Views: 3.4ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------
ChargeResultTest: test_should_belong_to_bulk_charge
---------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBulkCharge Create (0.2ms)[0m  [1m[32mINSERT INTO "bulk_charges" ("status", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["status", 0], ["created_at", "2025-07-29 17:04:37.149800"], ["updated_at", "2025-07-29 17:04:37.149800"]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 980190963], ["record_type", "BulkCharge"], ["name", "csv_file"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "sg826kkwirv6bzxs6jeyf6snxyve"], ["filename", "bulk-exercise.csv"], ["content_type", "text/csv"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 106], ["checksum", "fkLovX3TvThqJp+XaQAlTg=="], ["created_at", "2025-07-29 17:04:37.150982"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "csv_file"], ["record_type", "BulkCharge"], ["record_id", 980190963], ["blob_id", 1], ["created_at", "2025-07-29 17:04:37.151879"]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:04:37.152319"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: sg826kkwirv6bzxs6jeyf6snxyve (checksum: fkLovX3TvThqJp+XaQAlTg==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mBulkCharge Load (0.0ms)[0m  [1m[34mSELECT "bulk_charges".* FROM "bulk_charges" WHERE "bulk_charges"."id" = ?[0m  [["id", 980190963]]
  [1m[36mBulkCharge Update (0.0ms)[0m  [1m[33mUPDATE "bulk_charges" SET "updated_at" = ? WHERE "bulk_charges"."id" = ?[0m  [["updated_at", "2025-07-29 17:04:37.155557"], ["id", 980190963]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mChargeResult Create (0.1ms)[0m  [1m[32mINSERT INTO "charge_results" ("bulk_charge_id", "row_number", "status", "omise_charge_id", "token_response", "charge_response", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["bulk_charge_id", 980190963], ["row_number", nil], ["status", nil], ["omise_charge_id", nil], ["token_response", "[FILTERED]"], ["charge_response", nil], ["created_at", "2025-07-29 17:04:37.160572"], ["updated_at", "2025-07-29 17:04:37.160572"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
